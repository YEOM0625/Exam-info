# 물리 데이터베이스 설계
## 설계
### 설계 시 고려 사항
- 무결성
- 일관성
- 회복성
- 보안
- 효율성
- 확장성

## 반정규화★★★
### 개념
- 데이터벱이스 설계에서 정규화를 거친 후, <u>'성능 향상'이나 개발 및 운영의 편의성</u>을 위해 의도적으로 중복을 허용하거나 데이터를 재구성하는 기법
- 정규화로 인한 여러 테이블의 '조인'이 성능 저하를 일으킬 때, 반정규화는 이를 개선하기 위해 사용됨

### 반정규화 시 고려사항
- 데이터 중복으로 인해 데이터 무결성이 손살될 위험이 있음
- 읽기 작업은 빨라지지만, 삽입, 삭제, 수정 작업은 느려질 수 있음
- 저장 공간의 효율성이 감소할 수 있음
- 테이블이 커지고 복잡해져 유지보수가 어려워질 수 있음
- 과도한 반정규화는 성능 저하를 초래할 수 있음
- 반정규화 전에 데이터의 일관성과 무결성을 유지할 것인지, 데이터베이스의 성능을 우선할 것인지 결정해야 함

### 반정규화의 적용순서
- 반정규화 대상 조사
- 다른 방법으로 유도
- 반정규화 수행

### 반정규화의 유형
- 테이블 분할
  - 수평분할
    - 레코드 단위로 분할
  - 수직분할
    - 컬럼 단위로 분할
- 테이블 중복
  - 통계 테이블 추가
    - DW, OLAP 데이터 용
  - 진행 테이블 추가
    - 업무 프로세스 상태
- 컬럼기반 분할
  - 조회 빈도 기반
  - 크기 기반 분할
- 컬럼 중복
  - 중복 컬럼 추가
  - 파생 컬럼 추가

## 데이터베이스 이중화
### 데이터베이스 이중화 구성
- 장애에 대비하여 동일한 데이터베이스를 중복하여 관리하는 방식
- 고가용성(HA,High Availability)을 위한 정보 시스템의 지속적인 정상 운영을 목표로 함

### 데이터베이스 이중화의 목적
- 장애나 재해 발생 시 빠른 서비스 재개
- 서비스의 원활한 성능 보장

### 데이터베이스 이중화의 분류
- Eager 기법(그때 그때 반영)
  - 트랜잭션 발생 시 즉시 모든 이중화 서버에 변경 사항 반영
- Lazy 기법(끝나고 나서 반영)
  - 트랜잭션 완료 후 변경 사항을 트랜잭션 형태로 각 노드에 전달

### 데이터베이스 이중화의 종류
- Active-Active
  - 모든 다중화된 장비가 활성화된 상태
  - 높은 처리율을 보이나 구성이 복잡
- Active-Standby
  - 하나의 장비는 활성 상태, 다른 하나는 대기 상태
  - 장애 발생 시, 대기 중인 장비가 활성화 되어 서비스 지속
  - 종류: Hot Standby, Warm Standby, Cold Standby

## 데이터베이스 백업
### 데이터베이스 백업 개념
- 중단 사태(예: 정전, 사이버 공격)에 대비하여 데이터를 주기적으로 <u>복사</u>하여 보관하는 것
- 백업: 데이터를 복사하여 보관하는 과정
- 복원: 손상된 데이터베이스를 원래 상태로 되돌리는 과정

### 백업 방식
- 전체 백업(Full Backup)
  - 지정된 폴더의 모든 데이터를 백업
- 증분 백업(Incremental Backup)
  - 최근 전체 백업 이후 변경/추가된 데이터만 백업
  - 풀백업+월요일 백업 / 풀백업+화요일 백업
- 차등 백업(Differential Backup)
  - 최근 전체 백업 이후 모든 변경/추가된 데이터를 백업
  - 풀백업+월요일 백업/ 풀백업+(월+화)백업
- 실시간 백업(RealTime Backup)
  - 데이터가 변경될 떄마다 즉시 백업
- 트랜잭션 로그 백업(Transaction log Backup)
  - 실행된 SQL문을 기록한 로그로, REDO 및 UNDO 작업을 통해 데이터베이스를 복원
  - REDO(다시 실행), UNDO(원상태로 복구)로 복원
  - CHECK POINT는 트랜잭션이 디스크에 확실히 저장된 지점을 나타냄
- 합성 백업
  - 기존의 전체 백업본+여러개의 <u>증분백업</u> = 새로운 전체 백업

### 복구 시간 목표/복구 시점 목표
- 복구 시간 목표(RTO)
  - 서비스가 중단된 후 서비스를 다시 복원할 때까지 <u>허용되는 최대 시간</u>
  - 서비스를 사용할 수 없는 상태로 허용되는 기간
- 복구 시점 목표(RPO)
  - 마지막 백업 이후 허용되는 최대 데이터 손실 시간
  - 마지막 복구 시점과 서비스 중단 시점 사이에 <u>허용되는 데이터 손실량</u>


## 데이터베이스 암호화
- API 방식
  - 애플리케이션에서 데이터의 암/복호화 수행
- Plug-in 방식
  - DB 서버에 제품 설치 후 암/복호화 수행
- TDE 방식(Transparent Data Encryption)
  - DBMS 내부에서 암/복호화 처리, 인덱스와 연동 가능
- 파일암호화 방식
- 하드웨어 방식

### 데이터베이스 암호화 국가정보원 권고사항
- 안전한 알고리즘
  - 검증된 암호모듈, 알고리즘 사용
  - SEED,ARIA,SHA-256
- 암호 키 관리
  - 암호키의 안전한 관리
- 데이터 암/복호화
  - 중요 데이터의 안전성 확보
- 접근통제
  - 비인가자의 접근 차단
- 암호통신
  - 전송 데이터의 기밀성, 무결성 유지
  - <u>IPSec, SSL, SHTTP, TLS</u>


